# 键鼠穿越测试功能使用指南

## 概述

我已经为您的应用添加了完整的键鼠穿越测试功能，包括：
1. 在主页面（Index.ets）集成了键鼠穿越按钮
2. 创建了专门的键鼠穿越测试页面（CooperateTest.ets）
3. 添加了菜单导航入口

## 🚀 测试功能概览

### 主页面集成功能

在您的主页面（`pages/Index.ets`）中，我添加了：

#### 状态显示
- **键鼠穿越状态**：实时显示当前状态（未连接、准备中、已激活等）
- **目标设备信息**：显示当前选择的目标设备名称
- **状态颜色指示**：不同状态使用不同颜色标识

#### 控制按钮
**横屏模式**：
- 🖱️ **开始键鼠穿越** - 橙色按钮，启动键鼠穿越功能
- ⏹️ **停止键鼠穿越** - 橙色按钮，停止键鼠穿越功能
- 📱 **选择设备** - 灰色按钮，选择目标设备

**竖屏模式**：
- 相同功能的按钮，针对竖屏布局优化

#### 菜单选项
- 在右上角菜单中添加了 "🖱️ 键鼠穿越测试" 选项
- 点击可跳转到专门的测试页面

### 专门测试页面

创建了 `pages/CooperateTest.ets` 专门用于测试键鼠穿越功能：

#### 功能特点
1. **简洁界面**：专注于键鼠穿越功能测试
2. **完整状态显示**：详细显示初始化状态和运行状态
3. **设备管理**：列出所有可用设备，支持选择和切换
4. **实时信息**：显示鼠标位置信息
5. **错误处理**：完善的错误提示和日志记录

#### 页面布局
```
┌─────────────────────────────┐
│ ← 返回    键鼠穿越测试        │
├─────────────────────────────┤
│ 当前状态                     │
│ • 初始化: 已初始化            │
│ • 状态: 空闲                 │
├─────────────────────────────┤
│ 设备选择                     │
│ • 已选择: 设备名称            │
│ • [设备1] [设备2] [设备3]    │
│ • [刷新设备列表]             │
├─────────────────────────────┤
│ 控制操作                     │
│ • [开始穿越] [停止穿越]       │
│ • [检查设备支持]             │
├─────────────────────────────┤
│ 鼠标位置信息                 │
│ • 设备: xxx                  │
│ • X: 100, Y: 200            │
│ • 屏幕: 1920x1080           │
└─────────────────────────────┘
```

## 🎯 如何测试

### 1. 基本测试流程

1. **启动应用**
   - 应用启动时会自动初始化键鼠穿越功能
   - 查看状态显示确认初始化成功

2. **选择目标设备**
   - 点击"选择设备"按钮
   - 如果有多个设备，会自动选择第一个
   - 确保设备已在设备管理器中建立信任关系

3. **开始键鼠穿越**
   - 点击"🖱️ 开始键鼠穿越"按钮
   - 观察状态变化：空闲 → 准备中 → 已准备 → 启动中 → 已激活
   - 成功后会显示"键鼠穿越启动成功"

4. **测试功能**
   - 移动鼠标，观察鼠标位置信息更新
   - 尝试在目标设备上进行操作

5. **停止穿越**
   - 点击"⏹️ 停止键鼠穿越"按钮
   - 状态变为：停止中 → 空闲

### 2. 专门测试页面

1. **进入测试页面**
   - 方式1：主页面右上角菜单 → "🖱️ 键鼠穿越测试"
   - 方式2：直接导航到 `/pages/CooperateTest`

2. **详细测试**
   - 查看初始化状态
   - 浏览可用设备列表
   - 选择不同设备进行测试
   - 检查设备支持状态
   - 观察详细的鼠标位置信息

## 📋 测试检查清单

### 基础功能测试
- [ ] 应用启动时键鼠穿越功能自动初始化
- [ ] 状态显示正确更新
- [ ] 设备选择功能正常
- [ ] 开始键鼠穿越功能正常
- [ ] 停止键鼠穿越功能正常
- [ ] 错误提示正常显示

### 设备兼容性测试
- [ ] 检查设备支持状态功能
- [ ] 多设备切换测试
- [ ] 设备连接/断开场景测试

### 状态管理测试
- [ ] 状态转换正确（空闲→准备→激活→停止）
- [ ] 按钮启用/禁用状态正确
- [ ] 重复操作处理正确

### 鼠标追踪测试
- [ ] 鼠标位置信息实时更新
- [ ] 屏幕尺寸信息正确
- [ ] 跨设备鼠标移动正常

## 🐛 常见问题排查

### 1. 初始化失败
**现象**：显示"键鼠穿越功能初始化失败"
**排查**：
- 检查应用权限：`ohos.permission.COOPERATE_MANAGER`
- 确认设备支持键鼠穿越功能
- 查看日志获取详细错误信息

### 2. 没有可用设备
**现象**：设备列表为空或显示"没有可用设备"
**排查**：
- 进入设备管理器添加设备
- 确认设备间已建立信任关系
- 点击"刷新设备列表"重新加载

### 3. 启动失败
**现象**：点击开始按钮后出现错误
**排查**：
- 确认目标设备在线且支持键鼠穿越
- 检查网络连接状态
- 确认目标设备的键鼠穿越开关已开启

### 4. 鼠标位置不更新
**现象**：鼠标位置信息始终显示"无鼠标位置信息"
**排查**：
- 确认键鼠穿越已成功激活
- 检查目标设备是否支持鼠标位置追踪
- 尝试移动鼠标到目标设备

## 📊 日志和调试

### 日志标签
- `[Index]` - 主页面相关日志
- `[CooperateTest]` - 测试页面相关日志
- `[CooperateManager]` - 管理器相关日志
- `[CooperateService]` - 服务相关日志

### 关键日志
```
初始化：Initializing cooperate manager...
状态变化：Cooperate status changed: active
设备选择：Starting cooperate to device: xxx
错误信息：Cooperate error: xxx
```

## 🔧 自定义和扩展

### 添加更多测试功能
可以在测试页面中添加：
- 延迟测试
- 性能监控
- 批量设备测试
- 自动化测试脚本

### 修改UI样式
可以调整：
- 按钮颜色和大小
- 状态显示样式
- 布局和间距
- 图标和文字

### 增强错误处理
可以添加：
- 重试机制
- 详细错误码显示
- 自动恢复功能
- 用户指导提示

## 📞 技术支持

如果您在测试过程中遇到问题：
1. 查看应用日志获取详细信息
2. 参考 `README_COOPERATE.md` 了解API详情
3. 检查设备兼容性和权限配置
4. 确认网络连接和设备状态

祝您测试顺利！🎉
